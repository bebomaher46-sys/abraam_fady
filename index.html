<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Oust Hospital System</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:'Segoe UI',Tahoma;background:#eef3f7;display:flex;flex-direction:column;min-height:100vh}
.sidebar{width:260px;background:#0f2027;color:#fff;padding:20px;display:flex;flex-direction:column;flex-shrink:0}
.sidebar h2{text-align:center;color:#00d2ff}
.menu-btn{background:none;border:none;color:#ddd;padding:12px;text-align:right;border-radius:6px;margin-bottom:8px;font-size:1em;cursor:pointer}
.menu-btn.active,.menu-btn:hover{background:rgba(255,255,255,.15);color:#00d2ff}
.content{flex:1;padding:15px;overflow:auto}
.section{display:none;background:#fff;padding:15px;border-radius:12px;box-shadow:0 5px 15px rgba(0,0,0,.1)}
.section.active{display:block}
h1{border-bottom:3px solid #00d2ff;display:inline-block}
input,select{width:100%;padding:10px;margin-bottom:10px;border:1px solid #ccc;border-radius:6px}
.btn{padding:10px 15px;border:none;border-radius:6px;font-weight:bold;cursor:pointer}
.btn-success{background:#27ae60;color:#fff}
.btn-danger{background:#e74c3c;color:#fff}
table{width:100%;border-collapse:collapse;margin-top:15px}
th,td{border:1px solid #ddd;padding:10px;text-align:center}
th{background:#0f2027;color:#fff}
.invoice{border:2px dashed #00d2ff;padding:15px;margin-top:15px;border-radius:10px}
.meds-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:12px}
.med-item{border:1px solid #ccc;padding:10px;border-radius:10px;text-align:center;background:#f9faff;transition:0.2s;cursor:pointer}
.med-item:hover{background:#d6f0ff;transform:translateY(-3px)}

/* Responsive */
@media (min-width: 768px) {
  body{flex-direction:row}
  .content{padding:25px}
}
@media (max-width: 767px) {
  .sidebar{width:100%;flex-direction:row;overflow-x:auto}
  .menu-btn{flex:1;white-space:nowrap;margin-right:5px}
  .content{padding:10px}
  table, .meds-grid{font-size:14px}
}
</style>
</head>
<body>
<div class="sidebar">
<h2>Oust Hospital</h2>
<button class="menu-btn active" id="btnDoctors">ğŸ‘¨â€âš•ï¸ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡</button>
<button class="menu-btn" id="btnPatients">ğŸ§‘â€ğŸ¤â€ğŸ§‘ Ø§Ù„Ù…Ø±Ø¶Ù‰</button>
<button class="menu-btn" id="btnPharmacy">ğŸ’Š Ø§Ù„ØµÙŠØ¯Ù„ÙŠØ©</button>
<button class="menu-btn" id="btnBilling">ğŸ§¾ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</button>
</div>
<div class="content">
<div id="doctors" class="section active">
<h1>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡</h1>
<input id="dName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø¨ÙŠØ¨">
<input id="dSpec" placeholder="Ø§Ù„ØªØ®ØµØµ">
<input id="dPrice" type="number" placeholder="Ø³Ø¹Ø± Ø§Ù„ÙƒØ´Ù">
<button class="btn btn-success" onclick="addDoctor()">Ø¥Ø¶Ø§ÙØ©</button>
<table id="doctorsTable"></table>
</div>
<div id="patients" class="section">
<h1>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±Ø¶Ù‰</h1>
<input id="pName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø±ÙŠØ¶">
<input id="pAge" type="number" placeholder="Ø§Ù„Ø³Ù†">
<button class="btn btn-success" onclick="addPatient()">Ø¥Ø¶Ø§ÙØ©</button>
<table id="patientsTable"></table>
</div>
<div id="pharmacy" class="section">
<h1>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙŠØ¯Ù„ÙŠØ©</h1>
<input id="mName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡">
<input id="mPrice" type="number" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¯ÙˆØ§Ø¡">
<input id="mQty" type="number" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
<button class="btn btn-success" onclick="addMedicine()">Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ§Ø¡</button>
<table id="medsTable"></table>
</div>
<div id="billing" class="section">
<h1>Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø©</h1>
<select id="patientSelect"></select>
<select id="doctorSelect"></select>
<h3>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø¯ÙˆÙŠØ©</h3>
<div id="medsGrid" class="meds-grid"></div>
<button class="btn btn-success" onclick="createInvoice()">Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø©</button>
<div id="invoices"></div>
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
let doctors=JSON.parse(localStorage.getItem('doctors'))||[];
let patients=JSON.parse(localStorage.getItem('patients'))||[];
let medicines=JSON.parse(localStorage.getItem('medicines'))||[];
let invoices=JSON.parse(localStorage.getItem('invoices'))||[];

function save(){
 localStorage.setItem('doctors',JSON.stringify(doctors));
 localStorage.setItem('patients',JSON.stringify(patients));
 localStorage.setItem('medicines',JSON.stringify(medicines));
 localStorage.setItem('invoices',JSON.stringify(invoices));
}

function switchSection(sectionId, btn){
 document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
 document.getElementById(sectionId).classList.add('active');
 document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
 btn.classList.add('active');
 render();
}

document.getElementById('btnDoctors').addEventListener('click', ()=>switchSection('doctors', document.getElementById('btnDoctors')));
document.getElementById('btnPatients').addEventListener('click', ()=>switchSection('patients', document.getElementById('btnPatients')));
document.getElementById('btnPharmacy').addEventListener('click', ()=>switchSection('pharmacy', document.getElementById('btnPharmacy')));
document.getElementById('btnBilling').addEventListener('click', ()=>switchSection('billing', document.getElementById('btnBilling')));

function addDoctor(){if(!dName.value||!dSpec.value||!dPrice.value) return alert('Ø§ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'); doctors.push({id:Date.now(),name:dName.value,spec:dSpec.value,price:+dPrice.value}); dName.value=dSpec.value=dPrice.value=''; save(); render();}
function addPatient(){if(!pName.value||!pAge.value) return alert('Ø§ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'); patients.push({id:Date.now(),name:pName.value,age:+pAge.value}); pName.value=pAge.value=''; save(); render();}
function addMedicine(){if(!mName.value||!mPrice.value||!mQty.value) return alert('Ø§ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'); medicines.push({id:Date.now(),name:mName.value,price:+mPrice.value,qty:+mQty.value}); mName.value=mPrice.value=mQty.value=''; save(); render();}

function createInvoice(){
 let p=patients.find(p=>p.id==patientSelect.value);
 let d=doctors.find(d=>d.id==doctorSelect.value);
 if(!p||!d) return alert('Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±ÙŠØ¶ ÙˆØ§Ù„Ø¯ÙƒØªÙˆØ±');
 let selectedMeds=[]; let total=d.price;
 document.querySelectorAll('.med-item input:checked').forEach(c=>{
   let med=medicines.find(m=>m.id==c.value);
   if(med && med.qty>0){med.qty--; selectedMeds.push(med.name); total+=med.price;}
 });
 let inv={id:Date.now(),patient:p.name,doctor:d.name,meds:selectedMeds,total,date:new Date().toLocaleString()};
 invoices.push(inv); save(); render();
}

function generateInvoicePDF(inv){
 const { jsPDF } = window.jspdf;
 const doc = new jsPDF();
 doc.setFontSize(16);
 doc.text('ÙØ§ØªÙˆØ±Ø© Ù…Ø³ØªØ´ÙÙ‰ Oust', 105, 20, null, null, 'center');
 doc.setFontSize(12);
 doc.text(`Ø§Ù„ØªØ§Ø±ÙŠØ®: ${inv.date}`, 14, 35);
 doc.text(`Ø§Ù„Ù…Ø±ÙŠØ¶: ${inv.patient}`, 14, 45);
 doc.text(`Ø§Ù„Ø¯ÙƒØªÙˆØ±: ${inv.doctor}`, 14, 55);
 let y = 65;
 inv.meds.forEach((m,i)=>{doc.text(`${i+1}- ${m}`,14,y); y+=10});
 doc.text(`Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${inv.total} Ø¬Ù†ÙŠÙ‡`,14,y+10);
 doc.save(`Invoice_${inv.id}.pdf`);
}

function render(){
 doctorsTable.innerHTML='<tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„ØªØ®ØµØµ</th><th>Ø§Ù„Ø³Ø¹Ø±</th></tr>'+doctors.map(d=>`<tr><td>${d.name}</td><td>${d.spec}</td><td>${d.price}</td></tr>`).join('');
 patientsTable.innerHTML='<tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ø³Ù†</th></tr>'+patients.map(p=>`<tr><td>${p.name}</td><td>${p.age}</td></tr>`).join('');
 medsTable.innerHTML='<tr><th>Ø§Ù„Ø¯ÙˆØ§Ø¡</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th></tr>'+medicines.map(m=>`<tr><td>${m.name}</td><td>${m.price}</td><td>${m.qty}</td></tr>`).join('');
 patientSelect.innerHTML=patients.map(p=>`<option value='${p.id}'>${p.name}</option>`).join('');
 doctorSelect.innerHTML=doctors.map(d=>`<option value='${d.id}'>${d.name}</option>`).join('');
 medsGrid.innerHTML=medicines.map(m=>`<div class='med-item'><label><input type='checkbox' value='${m.id}'> ${m.name} (${m.price})</label></div>`).join('');
 invoicesDiv.innerHTML=invoices.map(i=>`<div class='invoice'><b>Ø§Ù„Ù…Ø±ÙŠØ¶:</b> ${i.patient}<br><b>Ø§Ù„Ø¯ÙƒØªÙˆØ±:</b> ${i.doctor}<br><b>Ø§Ù„Ø£Ø¯ÙˆÙŠØ©:</b> ${i.meds.join(', ')||'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}<br><b>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</b> ${i.total} Ø¬Ù†ÙŠÙ‡<br><b>Ø§Ù„ØªØ§Ø±ÙŠØ®:</b> ${i.date}<br><button class='btn btn-success' onclick='generateInvoicePDF(${i.id})'>Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button></div>`).join('');

 invoices.forEach(inv=>{
   let btn = document.querySelector(`.invoice button[onclick='generateInvoicePDF(${inv.id})']`);
   if(btn) btn.onclick = () => generateInvoicePDF(inv);
 });
}

let invoicesDiv=document.getElementById('invoices');
render();
</script>
</body>
</html>
